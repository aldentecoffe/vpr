# Лабораторная работа #12 - Cетевые утилиты Linux.

Вам предстоит изучить утилиты для захвата сетевого трафика, научиться анализировать захваченные пакеты, извлекать из них полезную информацию.

## Материалы
- [...](./.docx)

## Работа

Нам потребуется 2 ВМ. Я буду использовать одну [Ubuntu Desktop](https://ubuntu.com/download/desktop#downloads) а вторую [Ubuntu Server](https://ubuntu.com/download/server#downloads)

Также нам потребуется настроить [**Сеть NAT**](https://github.com/xarll/vpr/blob/main/items/os1/lab6_2/README.md#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D1%81%D0%B5%D1%82%D1%8C-nat) или любую другую сеть между машинами


#### 1. Утилита TCPDump

Утилита TCPDump представляет собой мощный и популярный инструмент для перехвата и анализа сетевых пакетов. Она позволяет просматривать все входящие и исходящие из определенного интерфейса пакеты и работает в командной строке. Её использование необходимо в случаях, когда невозможно запустить Wireshark, например, в операционных системах без графической оболочки. Данная утилита часто используется для устранения неполадок в сети, а также для обеспечения безопасности.


Если tcpdump запустить без параметров, он будет выводить информацию обо всех сетевых пакетах. С помощью параметра -i можно указать сетевой интерфейс, с которого следует принимать данные, например:

```bash
sudo tcpdump -i enp0s8
```

Чтобы посмотреть названия всех доступных для захвата интерфейсов, нужно запустить `TCPDump` с ключом `-D`.
Для более точной настройки работы `TCPDump` можно использовать один из перечисленных далее параметров, или их комбинацию.
—	выводить сокращённую информацию: `-q`;
—	выводить подробную информацию: `-v` `-vv` `-vvv` (чем больше v, тем подробнее информация);
—	не преобразовывать порты: `-n` (вместо названий, например, http или ftp будут показываться номера, для указанных протоколов: 80 и 21);
—	не преобразовывать имена: `-nn` (вместо имён компьютеров, например, UbuntuServer1804 будут показываться их IP-адреса);
—	показывать MAC-адреса: `-e`;
—	захватить только определённое количество пакетов: `-с количество`;

Для протокола, чьи пакеты должны захватываться, достаточно указать его название, например:
```bash
tcpdump icmp
```
или
```bash
tcpdump udp port 53
```
Параметр port позволяет ограничить для захватываемого трафика порт или их диапазон. Данный параметр применим только к протоколам `TCP` и `UDP`.
По умолчанию `TCPDump` выводит информацию о захваченных пакетах на экран, однако её можно записывать в файл. Для это используется параметр `-w`:
```bash
tcpdump -w /home/student/1.cap
```
Полученный в результате файл имеет формат, совместимый с `Wireshark` и может быть в дальнейшем проанализирован в данной программе с использованием более наглядного графического интерфейса, а также широких возможностей по созданию фильтров и подсчёту статистики.

#### 1.1 С помощью утилиты TCPDump захватите и выведите на экран информацию из входящих пакетов протоколов HTTP и ICMP.

```bash
tcpdump "icmp or (port 80 or port 443)"
```

![image](https://github.com/xarll/vpr/assets/76239707/b7c30b7c-3aa7-40f9-b146-08f0b8513d34)

#### 1.2. С помощью утилиты TCPDump захватите и запишите в файл трафик, передаваемый виртуальной машиной с Ubuntu Server в процессе обращения к ней по протоколу HTTP и выполнения команды ping.

```bash
tcpdump "icmp or (port 80 or port 443)" -w /home/jkearnsl
```



*Авторство: **Бояршинов Н.О***
